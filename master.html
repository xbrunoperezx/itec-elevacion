<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta name="robots" content="noindex, nofollow">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Librería XLS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.5/xlsx.full.min.js"></script>
    <!-- Materialize CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <!-- Materialize JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <!-- Importación de Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Tu propio CSS personalizado -->
    <link rel="stylesheet" type="text/css" href="css/styles.css">
    <title>SGASTUR - SGA Elevación 2</title>
  
</head>
<body>
    <!--creamos un contenedor para poder dibujar o escribir dentro de el con  una clase y una id (resultado sera el pincel)-->
    <div class="container" id="resultado">
        <h5>Clientes</h5>
    </div>


    
    <!--Scrip de peticion back via ajax-->
    <script>
        $(document).ready(function(){  //cargamos la web (el JS) nada mas acceder a la Url
            $.ajax({ //aqui hacemos la peticion de los datos al back (ajax no recarga la pagina)
                //donde lo llamo 
                type:"POST",
                //como lo llamo
                url:"services/clientes.php", 
                //que mando
                data:{  
                    filtro_total: 15
                },
                //que hago cuando vuelve? ->successs/error
                dataType: "json",
                success: function(response){ //el response es el objeto que vi en POSTMAN la respuesta en JSON
                    //aqui llega la respuesta el JSON

                    // 1º  ----pinto en consola-----
                    //console.log(response)

                    //2º  ----muestro un parrafo en el contenedor del div creado  por la id resultado.----
                    //$('#resultado').html('<p>Hola, el js funciona </p>')

                    //3º  --- ahora filtro  que cliente  quiero mostrar en  la  posicion----
                    //let cliente= response.resultados[0];

                    //--- aqui elijo que datos quiero mostrar/pintar llamando a cliente siempre---
                    //let html= `

                        //<p> 
                            //<strong>Nombre:</strong> ${cliente.nombre}<br>
                            //<strong>direccion:</strong> ${cliente.direccion}
                        //</p>    
                    //`;

                    //---muestro los dos clientes en parrafos con su nombre y direccion
                    //$('#resultado').html(html)

                    
                    //4º  ---creamos un acumulador para no sobrescribir cada vuelta el cliente---
                    let html = "";
                    let contador = 1;
                    //recorremos el array "response.resultados" con cada cliente
                    response.resultados.forEach(function(cliente){
                         
                        //con el acumulador creado vamos añadiendo al html cada iteraccion del bucle un cliente 
                        html += `
                            <div class= "card-panel">
                                <h5><strong> cliente nº </strong>${contador}</h5> 
                                <p>
                                    <strong> Nombre: </strong> ${cliente.nombre}<br>
                                    <strong> Direccion: </strong> ${cliente.direccion}<br>
                                </p>   
                           
                            </div>          

                        
                        `;
                        contador ++;
                    });
                    
                    $('#resultado').html(html);
                }
               
              //cierre de ajax
            })
          //cierre de la funcion de carga   
        })

        
    </script>
</body>
</html>